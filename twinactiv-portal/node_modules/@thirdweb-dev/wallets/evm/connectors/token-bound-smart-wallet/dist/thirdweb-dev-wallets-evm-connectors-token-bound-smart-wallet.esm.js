import { ethers } from 'ethers';
import { SmartWalletConnector } from '../../smart-wallet/dist/thirdweb-dev-wallets-evm-connectors-smart-wallet.esm.js';
import { E as ERC6551_REGISTRY } from '../../../../dist/constants-4d8cdb44.esm.js';
import '../../../../dist/connector-20f7cf73.esm.js';
import 'eventemitter3';
import '@account-abstraction/sdk';
import '../../../../dist/url-453bcd09.esm.js';
import '@thirdweb-dev/chains';
import '@account-abstraction/contracts';
import '../../../../dist/defineProperty-e24c82ea.esm.js';
import '@account-abstraction/utils';
import '@thirdweb-dev/sdk';

class TokenBoundSmartWalletConnector extends SmartWalletConnector {
  constructor(input) {
    super({
      ...input,
      factoryAddress: input.registryAddress || ERC6551_REGISTRY
    });
    this.tbaConfig = input;
    // TODO default account implementation address
  }

  defaultFactoryInfo() {
    return {
      createAccount: async factory => {
        return factory.prepare("createAccount", [this.tbaConfig.accountImplementation, this.chainId, this.tbaConfig.tokenContract, this.tbaConfig.tokenId, this.tbaConfig.salt, ethers.utils.toUtf8Bytes("")]);
      },
      getAccountAddress: async factory => {
        return await factory.call("account", [this.tbaConfig.accountImplementation, this.chainId, this.tbaConfig.tokenContract, this.tbaConfig.tokenId, this.tbaConfig.salt]);
      }
    };
  }
}

export { TokenBoundSmartWalletConnector };
